$(function(){var s=$.cookie("token"),a="",e=0,i=0;$.ajax({type:"get",url:" http://47.104.244.134:8080/cartlist.do",async:!0,data:{token:s},success:function(t){for(var n=0;n<t.length;n++)a+="<ul><input type='checkbox' class='fu'><li><img src="+t[n].goods.picurl+"></li><li><p>"+t[n].goods.name+"</p></li><li class='a q'><span class='pri'><span>￥</span><span class='price'>"+t[n].goods.price+"</span></span></li><li class='e'><span><button class='add1'>-</button><input readonly='true' type='text' class='count' value="+t[n].count+"><button class='add2'>+</button></span></li><li class='w'><span class='shuzi'><span>￥</span><span class='shuzi1'>"+t[n].goods.price*t[n].count+"</span></span></li><li class='r'><span>删除</span></li><figure class='figure'>"+t[n].id+"</figure><aside  class='aside'>"+t[n].gid+"</aside><nav>"+t[n].count+"</nav></ul>",e+=t[n].goods.price*t[n].count,i+=t[n].count,$(".money").text(0),$(".allgoods").text(i);$(".goods-buy ").html(a),$(".goods-buy ul").find(".r").click(function(){var t=parseInt($(this).parent().find("figure").text()),n=parseInt($(this).parent().find("aside").text()),a=parseInt($(this).parent().find("count").val());console.log(n,a,t),$.ajax({type:"get",url:" http://47.104.244.134:8080/cartupdate.do",async:!0,data:{token:s,id:t,gid:n,num:0},success:function(t){window.location.href="shopCar.html"}})}),$(".goods-buy ul").find(".add1").click(function(){var t=parseInt($(this).parent().find(".count").val()),n=parseInt($(this).parent().parent().siblings().find(".pri").find(".price").text()),a=(parseInt($(this).parent().parent().siblings().find(".shuzi1").text()),parseInt($(this).parent().parent().parent().find(".figure").text())),s=parseInt($(this).parent().parent().parent().find(".aside").text());if((t-=1)<1)return t=1,$(this).parent().find(".count").val(t),$(this).css({background:"#CECECE",cursor:"not-allowed"}),void $(this).attr("disabled",!0);$(this).parent().find(".count").val(t);var e=$.cookie("token");$.ajax({type:"get",url:" http://47.104.244.134:8080/cartupdate.do",data:{id:a,gid:s,num:-1,token:e},async:!0,success:function(t){window.location.href="shopCar.html"}}),$(this).parent().parent().siblings().find(".shuzi1").text(t*n)}),$(".goods-buy ul").find(".e").find(".add2").click(function(){var t=parseInt($(this).parent().find(".count").val()),n=parseInt($(this).parent().parent().siblings().find(".pri").find(".price").text()),a=$.cookie("token"),s=(parseInt($(this).parent().parent().parent().find("nav").text()),parseInt($(this).parent().parent().parent().find(".figure").text())),e=parseInt($(this).parent().parent().parent().find(".aside").text());0<=(t+=1)&&$(this).parent().find(".add1").css({background:"#E5E5E5"}),$.ajax({type:"get",url:" http://47.104.244.134:8080/cartupdate.do",data:{id:s,gid:e,num:1,token:a},async:!0,success:function(t){window.location.href="shopCar.html"}}),$(this).parent().find(".count").val(t),$(this).parent().parent().siblings().find(".shuzi1").text(t*n)}),$(".fu").click(function(){if($(this).prop("checked")){$(this).parent().css({background:"#FFF8E1"});var t=parseInt($(this).parent().find(".shuzi1").text());$(".money").text(t)}else $(this).parent().css({background:"#fff"}),$(".money").text(0)}),$(".quanxuan").click(function(){$(".quanxuan").prop("checked")?$(".money").text(e):$(".money").text(0)})}}),$(".quanxuan").click(function(){$(".quanxuan").prop("checked")?($(".goods-buy ul").css({background:"#FFF8E1"}),$(".fu").prop("checked",!0)):($(".goods-buy ul").css({background:"#fff"}),$(".fu").prop("checked",!1))}),null==$.cookie("token")&&$(".money").text(0),$.cookie("payWord")&&($(".payMoney").click(function(){$(".payGoods").show(),$(".mid").show()}),$(".passwordM").change(function(){var t=$.cookie("payWord");$(this).val()==t?($(".tishi8").show().text("支付密码正确"),$(".payGod").click(function(){alert("支付成功!三天后必有快递收!"),window.location.href="shopCar.html"})):(alert("密码错误!"),$(".mid").hide(),$(".payGoods").hide())}))});